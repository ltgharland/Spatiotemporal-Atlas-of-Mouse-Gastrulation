## Calculating Principal Components from the Extended Gastrulation scRNA Atlas for StabMAP

We used log-normalized counts from a downsampled version (10,000 cells per embryonic stage from E6.5 to E9.5) of the mouse gastrulation atlas from Imaz-Rosshandler et al., 2024, to perform three rounds of rPCA integration using Seurat v414. In round 1, rPCA integration was carried out across sequencing batches within each embryonic stage (e.g., E6.5) using 2,000 highly variable features identified with FindVariableFeatures. We applied FindIntegrationAnchors (k.anchor = 5, scale = FALSE), followed by IntegrateData (features.to.integrate = all features (genes), k.weight = 100). In round 2, batch-corrected count matrices from round 1 were integrated across all embryonic stages within each atlas version (original vs. extended). In round 3, integration was performed across both the original and extended atlas versions. For rounds 2 and 3, rPCA integration was executed with k.weight = 200 and k.anchor = 5, using PCs that were identified using a combined list of VariableFeatures (5716 genes) identified from each embryonic stage during round 1 of rPCA integration.
