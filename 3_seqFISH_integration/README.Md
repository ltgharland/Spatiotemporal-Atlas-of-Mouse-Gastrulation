Quality Control Filtering within an Embryonic Stage after Performing Integration and Clustering 

Initially, we applied batch correction using the rPCA method in Seurat v414 to log-normalized counts matrices from E7.25, E7.5 and E8.5 seqFISH embryos. rPCA integration was performed across different embryos (e.g., embryo 1 and embryo 2) within each embryonic stage (e.g., E7.25). To perform rPCA integration, principal components (PCs) were generated by running ScaleData and RunPCA using all seqFISH genes set as features. Integration was then carried out using FindIntegrationAnchors (with k.anchor = 5, scale = FALSE, and reduction = 'rpca'), followed by IntegrateData (with features.to.integrate = all features (genes) and k.weight = 100). Finally, clustering was performed after applying ScaleData and RunPCA on the batch-corrected matrices. We used FindNeighbors(dims = 1:30) and FindClusters(resolution = 1) to identify clusters. As a quality control measure, we excluded clusters with abnormal RNA/feature counts, as well as a cluster from the most distal region of the ectoplacental cone in E7.25 embryos (see SFig. 1b,d red clusters) prior to further analyses described below. 

rPCA Integration, Clustering and UMAP Generation for E7.25 and E7.5 seqFISH Embryos

We applied multiple rounds of batch correction using the rPCA method in Seurat v414 to log-normalized counts from E7.25 and E7.5 seqFISH embryos. Cells that passed the previously described quality control criteria were included in this analysis. In round 1, rPCA integration was performed across different embryos (e.g., embryo 1 and embryo 2) within each embryonic stage (e.g., E7.25). First, principal components (PCs) were generated by running ScaleData and RunPCA on all seqFISH probes. Integration was then carried out using FindIntegrationAnchors (with k.anchor = 5, scale = FALSE, and reduction = 'rpca'), followed by IntegrateData (with features.to.integrate = all features (genes) and k.weight = 100). In round 2, batch-corrected count matrices from round 1 were re-integrated using rPCA, with k.weight = 200 and k.anchor = 5. Finally, clustering was performed on the batch-corrected matrices after applying ScaleData and RunPCA. We used FindNeighbors(dims = 1:30) and FindClusters(resolution = 1.2) to identify clusters, followed by dimensionality reduction using UMAP, generated via RunUMAP(dims = 1:30). A second round of clustering was performed on a cluster that was initially annotated ‘Anterior Primitive Streak’ using FindNeighbors(dims = 1:30) and FindClusters(resolution = 1). This unsupervised sub-clustering revealed three transcriptionally and spatially distinct subpopulations within the original APS cluster: axial mesendoderm, definitive endoderm precursors, and a mixed cluster comprising primitive streak and axial mesendoderm cells. 

rPCA Integration, Clustering and UMAP Generation for E8.5 seqFISH Embryos

For the E8.5 seqFISH embryos, a similar procedure was followed. After quality control, batch-corrected count matrices from within-stage integration were processed with ScaleData and RunPCA. Clustering was then performed using FindNeighbors(dims = 1:30) and FindClusters(resolution = 1), and clusters were visualized via UMAP, generated using RunUMAP(dims = 1:30). 
